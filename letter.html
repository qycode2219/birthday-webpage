<!DOCTYPE html>
<html lang="en">
    <link href="https://fonts.googleapis.com/css2?family=ZCOOL+KuaiLe&display=swap" rel="stylesheet">
     <link href="https://fonts.googleapis.com/css2?family=Handlee&display=swap" rel="stylesheet">
    <head>
        <link rel="stylesheet" href="style/style-letter.css">
        <title>The most sincere letterâœ‰ï¸</title>
        <meta charset="UTF-8" name="viewport" content="width=divice-width,initial-scale=1.0">
        <script>
            document.addEventListener('click', function startMusic() {  
        const audio = document.getElementById('bgm');  
        audio.play();  
        document.removeEventListener('click', startMusic); // é˜²æ­¢é‡å¤æ’­æ”¾  
        });  
            let isOpen = false;
            function openpaper() {
                document.getElementById("paper-id").style.display = "flex";
                isOpen = true;
                setTimeout(typeWriter, 1000);
            }

            function heartJump() {
	  const heart = document.getElementById("heart");
	  heart.classList.remove("jump");
	  void heart.offsetWidth;
	  heart.classList.add("jump");
	}
const texts = [
`Dear Wong Zhi Qian , \n
This is the very first love letter I have ever written to you. Your sudden 
appearance disrupted my once ordinary and quiet life.Before you, I had no clear 
goal â€” I was just drifting aimlessly. But youâ€¦ you are truly wonderful. You are 
beautiful, and this is not empty flattery, but something I feel deeply from my 
heart. You are also so driven â€” you refuse to fall behind, always striving 
forward. This is what I deeply admire about you.Since you came into my life, I feel 
as if I have finally found the meaning of living. It may sound unbelievable, but it is 
truly real. You have made me start trying harder, becoming more serious about life.`,
`Whenever I feel like giving up, the thought of the future I wish to share with you immediately lifts me up and gives me strength. I have told myself countless times â€” you aretruly the most precious gift I have ever received.I know I am not perfect, I have my flaws and weaknesses, but I promise you this: I will always give my very best. I cannot guarantee that you will never face difficulties or sadness in the future, but I can promise that such pain will never come from me.I am serious â€” I truly wish for a future with you.Even if the road is full of challenges, even if we must wait for years, I am willing to walk beside you, hand in hand.

Would you be willing tooâ€¦?`
];

let page = 0;                         // å½“å‰é¡µ (0 æˆ– 1)
const speed = 70;
const idx = [0, 0];                   // æ¯ä¸€é¡µçš„æ‰“å­—è¿›åº¦
const finished = [false, false];      // æ¯ä¸€é¡µæ˜¯å¦æ‰“å®Œ

function typeWriter() {
  const el = document.getElementById(`letter-text${page + 1}`);
  const t = texts[page];

  if (idx[page] < t.length) {
    const ch = t.charAt(idx[page]);
    el.innerHTML += (ch === '\n') ? '\n' : ch;   // ä¿ç•™æ¢è¡Œ
    idx[page]++;
    setTimeout(typeWriter, speed);
  } else {
    finished[page] = true;
    // æ‰“å®Œå½“å‰é¡µæ‰æ˜¾ç¤ºâ€œâ†’â€ï¼Œä½†æœ€åä¸€é¡µä¸æ˜¾ç¤º
    if (page < texts.length - 1) {
      document.getElementById("next").style.display = "block";
    }
    // Last page show "next"
    if (page === texts.length - 1) {
      document.getElementById("nextBtn").style.display = "block";
    }
    if (page === 1){
      document.getElementById("nextBtn").style.display = "block";
    }
  }
}

function showPage(num) {
  // éšè—æ‰€æœ‰é¡µ
  document.querySelectorAll('.page').forEach(p => p.style.display = "none");

  // æ˜¾ç¤ºç›®æ ‡é¡µ
  document.getElementById(`letter-text${num}`).style.display = "block";

  // æ›´æ–°åœ†ç‚¹çŠ¶æ€
  document.getElementById("dot1").classList.toggle("active", num === 1);
  document.getElementById("dot2").classList.toggle("active", num === 2);

  // æŒ‰é’®é€»è¾‘
  if (num === 1) {
    document.getElementById("prev").style.display = "none"; // ç¬¬1é¡µæ²¡æœ‰ <
    document.getElementById("next").style.display = finished[0] ? "block" : "none"; // ç¬¬1é¡µæ‰“å®Œæ‰æœ‰ >
    document.getElementById("nextBtn").style.display = "none"; // ç¬¬1é¡µæ°¸è¿œæ²¡æœ‰ Next
  } else if (num === 2) {
    document.getElementById("prev").style.display = "block"; // ç¬¬2é¡µæ€»æœ‰ <
    document.getElementById("next").style.display = "none";  // ç¬¬2é¡µæ²¡æœ‰ >
    document.getElementById("nextBtn").style.display = finished[1] ? "block" : "none"; // æ‰“å®Œæ‰æœ‰ Next
  }

  // å¦‚æœè¿™é¡µæ²¡æ‰“è¿‡ï¼Œå°±æ‰“å­—
  page = num - 1;
  if (!finished[page]) {
    typeWriter();
  }
}

function openpaper() {
  document.getElementById("paper-id").style.display = "flex";

  page = 0; // é»˜è®¤æ‰“å¼€ç¬¬ä¸€é¡µ

  if (!finished[0]) {
    // ç¬¬ä¸€æ¬¡æ‰“å¼€ï¼Œç¬¬ä¸€é¡µè¿˜æ²¡æ‰“å®Œ
    setTimeout(typeWriter, 3000);
  } else {
    // å¦‚æœç¬¬ä¸€é¡µå·²ç»æ‰“å®Œ
    showPage(1);
  }
}


function closeLetter() {
  document.getElementById("paper-id").style.display = "none";
  document.getElementById("nextBtn").style.display = "none";
  document.getElementById("next").style.display = "none";
  document.getElementById("prev").style.display = "none";
}

function nextPage(){
  if (finished.every(v => v)){
    window.location.href = "future.html"
  }
}


        </script>
    </head>
    <body>
        <div class="envelope">
            <img src="images/Polar-Bear-icon.png" class="click-icon" alt="Polar Bear icon" onclick="openpaper()">
           <!-- <div class="icon-wrapper" onclick="openpaper()"></div>-->
            <div class="flap"></div>
            <div class="envelope-wrapper" onclick="openEnvelope()"></div>
            <div class="flap-bottom"></div>
            <div class="body"></div>
        </div>
        <div class="letter">
            <div class="letter-content">

            </div>
        </div>
        <audio id="bgm" src="audio/Athousandyear.mp3" loop></audio>
        <div class="zn1" >ğŸ’Œ å˜¿ï¼Œæˆ‘å·å·å†™äº†ä¸€å°ä¿¡ç»™ä½ å“Ÿ~ (Â´ï½¡â€¢ áµ• â€¢ï½¡`) â™¡</div> 
        <div class="paper" id="paper-id">
            <div class="paper-content">
                <div class="eng1" >
                    <!--Page1  -->
                    <p id="letter-text1" class="page" style="position: absolute; top: 0vh; left: 2vw;"></p>
                    <!--Page2-->
                    <p id="letter-text2" class="page" style="position: absolute; top: 0vh; left: 2vw;"></p>
                    <!--Arrows-->
                    <div class="arrow prev" id="prev" onclick="showPage(1)" style="display: none;">â®</div>
                    <div class="arrow next" id="next" onclick="showPage(2)" style="display: none;">â¯</div>
                    <!--Dot-->
                    <div class="pagination">
                        <span class="dot active" id="dot1" style="position: absolute; top: 110%; left: 47%"></span>
                        <span class="dot" id="dot2" style="position: absolute; top: 110%; left: 53%;"></span>
                    </div>
                    <button id="nextBtn" onclick="closeLetter()" style="display: none; position: absolute; bottom: -8vh; right: 5vw;  " >Next></button>
                </div>
            </div>
        </div>
        <div class="heart-wrapper">
    <div class="heart" onclick="heartJump();nextPage()" id="heart"></div>
  </div>
    </body>

</html>


